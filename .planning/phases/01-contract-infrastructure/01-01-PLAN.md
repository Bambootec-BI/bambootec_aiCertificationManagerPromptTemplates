---
phase: 01-contract-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - schemas/shared/format_standards.schema.json
  - schemas/shared/contract_versions.schema.json
  - schemas/skill_tree_builder.schema.json
  - schemas/skill_tree_to_content.schema.json
  - schemas/skill_to_practice_exercises.schema.json
  - schemas/skill_to_evaluation_exam.schema.json
  - schemas/custom_gpt_instructions.schema.json
autonomous: true

must_haves:
  truths:
    - "Each of the 5 template types has a corresponding JSON Schema"
    - "Format standards (indentation, list style, language policy) are defined once in shared schema"
    - "Schemas use JSON Schema Draft-07 for maximum validator compatibility"
  artifacts:
    - path: "schemas/shared/format_standards.schema.json"
      provides: "Centralized format definitions"
      contains: "indentation, list_style, language_policy, link_format"
    - path: "schemas/shared/contract_versions.schema.json"
      provides: "Version marker schema for template contracts"
      contains: "input_expects, output_produces"
    - path: "schemas/skill_tree_builder.schema.json"
      provides: "Schema for skill_tree_builder_template.json"
      exports: ["$id"]
    - path: "schemas/skill_tree_to_content.schema.json"
      provides: "Schema for skill_tree_to_content_tree_template.json"
      exports: ["$id"]
    - path: "schemas/skill_to_practice_exercises.schema.json"
      provides: "Schema for skill_to_practice_exercises_template.json"
      exports: ["$id"]
    - path: "schemas/skill_to_evaluation_exam.schema.json"
      provides: "Schema for skill_to_evaluation_exam_template.json"
      exports: ["$id"]
    - path: "schemas/custom_gpt_instructions.schema.json"
      provides: "Schema for custom_gpt_instructions.json (router)"
      exports: ["$id"]
  key_links:
    - from: "schemas/*.schema.json"
      to: "schemas/shared/format_standards.schema.json"
      via: "$ref"
      pattern: "\\$ref.*format_standards"
---

<objective>
Create JSON Schemas for all 5 template types with shared format standards defined once.

Purpose: Establish structural validation foundation so template changes can be caught before upload to Custom GPT
Output: 7 schema files (5 template schemas + 2 shared schemas)
</objective>

<execution_context>
@/Users/bambootec/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bambootec/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-contract-infrastructure/01-RESEARCH.md
@skill_tree_builder_template.json
@skill_tree_to_content_tree_template.json
@skill_to_practice_exercises_template.json
@skill_to_evaluation_exam_template.json
@custom_gpt_instructions.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared format standards and contract version schemas</name>
  <files>
    schemas/shared/format_standards.schema.json
    schemas/shared/contract_versions.schema.json
  </files>
  <action>
Create two shared schemas in schemas/shared/:

1. format_standards.schema.json - Define the canonical format rules:
   - "$schema": "https://json-schema.org/draft-07/schema"
   - "$id": "format_standards.schema"
   - Define definitions for:
     - indentation: { use_spaces_only: true (const), spaces_per_level: integer min 1, tabs_forbidden: true (const) }
     - list_style: { all_levels: string enum ["-", "*", "+"] }
     - language_policy: { instruction_language: enum ["English", "Spanish"], output_language: enum ["English", "Spanish"], exceptions: array of strings }
     - link_format: { preferred: string, fallback: string, forbidden: array of strings }
   - Add a "version" property (pattern: "^\d+\.\d+\.\d+$")

2. contract_versions.schema.json - Define version marker structure:
   - "$schema": "https://json-schema.org/draft-07/schema"
   - "$id": "contract_versions.schema"
   - Define:
     - format_standards: string (version expected)
     - input_expects: object mapping artifact name to "template@version" pattern
     - output_produces: object mapping artifact name to version pattern
  </action>
  <verify>
Both files exist and are valid JSON:
```bash
cat schemas/shared/format_standards.schema.json | jq '.'
cat schemas/shared/contract_versions.schema.json | jq '.'
```
  </verify>
  <done>
format_standards.schema.json defines indentation, list_style, language_policy, link_format with version property.
contract_versions.schema.json defines input_expects and output_produces patterns.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create template schemas for all 5 templates</name>
  <files>
    schemas/skill_tree_builder.schema.json
    schemas/skill_tree_to_content.schema.json
    schemas/skill_to_practice_exercises.schema.json
    schemas/skill_to_evaluation_exam.schema.json
    schemas/custom_gpt_instructions.schema.json
  </files>
  <action>
Create JSON Schema Draft-07 for each template. Analyze each template file to extract required structure:

1. skill_tree_builder.schema.json:
   - required: ["meta", "inputs", "instruction", "output"]
   - meta: required ["name", "version"], name const "skill_tree_builder", version pattern
   - inputs: required ["skill", "level", "context"]
   - instruction: required ["task", "hard_rules"]
   - output: object with output_1, output_2

2. skill_tree_to_content.schema.json:
   - required: ["template_version", "name", "inputs", "rules", "instruction", "output"]
   - inputs: required ["skill", "level", "context", "max_items_per_part"]
   - rules: required ["alignment", "sources_non_negotiable", "parts", "time_estimation", "time_total"]

3. skill_to_practice_exercises.schema.json:
   - Read the actual template file first
   - Extract required top-level keys
   - Define schema based on actual structure

4. skill_to_evaluation_exam.schema.json:
   - Read the actual template file first
   - Extract required top-level keys
   - Define schema based on actual structure

5. custom_gpt_instructions.schema.json:
   - required: ["main_instruction"]
   - main_instruction: required ["command", "global_rules", "workflows"]
   - global_rules: required ["language_policy", "formatting_policy"]
   - Embed format_standards reference for formatting_policy validation

Each schema MUST:
- Use "$schema": "https://json-schema.org/draft-07/schema"
- Have unique "$id" matching filename (e.g., "skill_tree_builder.schema")
- Include "$ref" to shared/format_standards.schema.json where formatting rules apply
- Use additionalProperties: true for flexibility (don't over-constrain)
  </action>
  <verify>
All 5 template schemas exist and are valid JSON:
```bash
for f in schemas/skill_tree_builder.schema.json schemas/skill_tree_to_content.schema.json schemas/skill_to_practice_exercises.schema.json schemas/skill_to_evaluation_exam.schema.json schemas/custom_gpt_instructions.schema.json; do
  echo "Checking $f..."
  cat "$f" | jq '.' > /dev/null && echo "  Valid JSON"
done
```
  </verify>
  <done>
All 5 template schemas exist with:
- Correct $schema and $id
- Required sections validated
- $ref to format_standards.schema.json where applicable
  </done>
</task>

</tasks>

<verification>
1. All 7 schema files exist in schemas/ directory
2. Each schema is valid JSON (parseable by jq)
3. Each schema has $schema pointing to Draft-07
4. Each schema has unique $id
5. Template schemas reference shared/format_standards.schema.json via $ref
</verification>

<success_criteria>
- 7 JSON Schema files exist (5 template + 2 shared)
- All schemas use JSON Schema Draft-07
- Format standards defined once in shared schema
- Schemas validate structural requirements without over-constraining
</success_criteria>

<output>
After completion, create `.planning/phases/01-contract-infrastructure/01-01-SUMMARY.md`
</output>
